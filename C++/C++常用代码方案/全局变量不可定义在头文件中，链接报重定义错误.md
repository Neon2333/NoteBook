# 起因
多文件编程时，在头文件中定义了一个全局变量，在源文件中使用该变量。编译时无错误，但是链接时发生错误。

# C/C++可以在不同源文件中定义同名变量吗？
不可以。编译过程按照文件进行编译后进行链接，链接过程中会发现在不同文件中两个同名变量，编译器无法知道使用哪个变量。

# 能否在头文件中定义全局变量？
不可以，因为源文件会include头文件，若在头文件中定义，则include后头文件会拷贝到各个源文件中，就会多次定义该全局变量，造成重定义。

# 全局变量的extern用法

extern最基本用法是声明全局变量。
* **声明**：声明不等于定义，只是声明了变量的名称，并未分配存储空间，如：iint i。
* **定义**：定义声明了变量的名称，同时为变量分配了存储空间。有时，定义会一次性完成声明和定义的功能。如 int i=0。声明可以多次，但定义只能一次。
* **作用域**：全局变量或局部变量，作用域均从定义处开始。
* **extern的作用**：原本全局变量的作用域从定义处开始直至当前C文件结束，加了extern以后，作用域从声明处直至当前C文件结束。
* **多文件，使用extern声明全局变量**：在多文件编程中，在A文件中定义全局变量g_i，在文件B中使用extern声明变量i，则可以在文件B中使用该全局变量，因为作用域从原本的文件A中扩展到了文件B的声明以后。<br>在实际编程中，变量遵从“一次定义，多次声明”的原则，即在一个文件中定义后，若要在其他文件中使用则需要先声明。（此时，编译器在编译完该文件后，发现该变量不是在本文件中定义的，就会在其他文件中进行搜寻。）

# 多文件的全局变量方法
**该全局变量只被一个源文件使用：** 直接将该全局变量定义在该文件中
**该全局变量被多个源文件使用：** 将变量定义在其中一个源文件中，然后在头文件中extern声明该变量。在需要用到该变量的源文件中include头文件即可。


# static用法
**延长局部变量的生命周期：** 用static声明局部变量，则局部变量变为静态局部变量，其生命周期会延长到程序结束后释放。
**限定作用域：** 用static修饰全局变量时，变量变为静态全局变量，只能在当前文件中被访问，即使加了extern声明也无法在其他文件中访问。修饰函数时，只能在当前文件被访问。

**静态变量：** 包括静态全局变量和静态局部变量。static修饰的局部变量和全局变量统称为静态变量，都放在静态区（全局区），若没有手动初始化，则编译器将其初始化为0。一旦内存被分配，直至程序结束才会被释放。

**静态局部变量：** 作用域为定义它的函数内部，程序仅为它分配一次内存。但是函数返回（函数结束）后，该变量不会消失（生命周期被延长）。而普通局部变量在函数返回后就被释放。